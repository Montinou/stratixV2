---
name: Migrate activity form component to API endpoints
status: completed
created: 2025-09-25T04:10:26Z
updated: 2025-09-25T05:14:09Z
github: [Will be updated when synced to GitHub]
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Migrate activity form component to API endpoints

## Description
Update `/components/okr/activity-form.tsx` to submit data via `/api/activities` instead of direct Supabase client calls. Activities are key progress tracking components for initiatives.

## Acceptance Criteria
- [ ] Activity creation form works correctly via API
- [ ] Activity editing form works correctly via API
- [ ] Initiative relationship maintained properly in activities
- [ ] Form validation works as before
- [ ] Loading and error states handled correctly
- [ ] Success feedback displayed to users
- [ ] Progress tracking calculations work correctly

## Technical Details
**Implementation Approach:**
- Replace form submission to use `fetch('/api/activities')` with POST/PUT methods
- Maintain initiative_id relationship in form data
- Update error handling for API response format
- Preserve existing form validation and UX patterns

**Key Considerations:**
- Activities must be linked to initiatives via initiative_id
- API handles progress calculations and relationships automatically
- Form data format must match API expectations
- Role-based permissions apply (activities owner-based access)

**Code Locations:**
- Primary: `/components/okr/activity-form.tsx`
- Related: Any initiative components that display activities

## Dependencies
- [ ] `/api/activities` endpoints (already exist and tested)
- [ ] Initiative relationships maintained in database (already working)
- [ ] User authentication and permissions (already operational)

## Effort Estimate
- Size: S
- Hours: 4-6 hours
- Parallel: true (independent of other form migrations)

## Definition of Done
- [ ] Activity forms submit via API endpoints successfully
- [ ] Initiative relationships preserved and functional
- [ ] Form validation and UX maintained
- [ ] Manual testing completed for both create/edit scenarios
- [ ] TypeScript compilation successful with no errors